!function(){"use strict";angular.module("app",["ui.router","app.ui","ui.bootstrap"]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/projects"),t.state("login",{url:"/login",templateUrl:"partials/login/index.html",controller:"LoginController",controllerAs:"loginController"}),t.state("projects",{url:"/projects",templateUrl:"partials/projects/index.html",controller:"ProjectsController",controllerAs:"projectsController",resolve:{projects:["Projects","users",function(t,e){return t.get()}],users:["Users",function(t){return t.get()}]}}).state("projects.detail",{url:"/:projectId",templateUrl:"partials/projects/detail.html",controller:"ProjectController",controllerAs:"projectController",resolve:{project:["Projects","$stateParams","projects",function(t,e,r){return t.find(e.projectId)}]}}).state("projects.detail.edit",{url:"/edit",templateUrl:"partials/projects/edit.html",controller:"ProjectEditController",controllerAs:"projectEditController"})}])}(),function(){"use strict";angular.module("app.ui",[])}(),function(){"use strict";angular.module("app").controller("BodyController",["Projects",function(t){var e=this;e.welcome="Sup",t.get().then(function(r){e.projects=t.projects})}])}(),function(){"use strict";angular.module("app.ui").directive("projectsTable",function(){return{restrict:"EA",templateUrl:"partials/directives/projects-table.html",scope:{projects:"=",remove:"="}}})}(),function(){"use strict";angular.module("app").factory("User",function(){function t(t){_.merge(this,{first_name:"",last_name:"",email:""},t||{})}return t.prototype={fullName:function(){return this.first_name+" "+this.last_name}},t})}(),function(){"use strict";angular.module("app").controller("LoginController",function(){})}(),function(){"use strict";angular.module("app").service("Projects",["$http","$state","Users",function(t,e,r){var o=this;o.projects=[],o.find=function(t){return _.find(o.projects,{_id:t})},o.get=function(){return t.get("/projects").then(function(t){return o.projects.splice(0),t.data.forEach(function(t){t.user=r.find(t.user),o.projects.push(t)}),o.projects})},o.put=function(r){var n={title:r.title,user:r.user._id};return t.put("/projects/"+r._id,n).then(function(t){var n=o.find(r._id);_.merge(n,r),e.go("projects.detail",{projectId:r._id})},function(t){})},o.remove=function(t){_.remove(o.projects,{_id:t})},o.del=function(r){return t["delete"]("/projects/"+r).then(function(t){o.remove(r),e.go("projects")})},o.post=function(e){return t.post("/projects/",e).then(function(t){t.data.user=r.find(t.data.user),o.projects.push(t.data)})}}])}(),function(){"use strict";angular.module("app").service("Users",["$http","User",function(t,e){var r=this;r.users=[],r.find=function(t){return _.find(r.users,{_id:t})},r.get=function(){return t.get("/users").then(function(t){return r.users.splice(0),t.data.forEach(function(t){r.users.push(new e(t))}),r.users})}}])}(),function(){"use strict";angular.module("app.ui").filter("niceDate",function(){return function(t,e){e=e||"MMMM Do, YYYY";var r=moment(t);return r.format(e)}})}(),function(){"use strict";angular.module("app").controller("NewProjectCtrl",["$scope","$modalInstance","Users",function(t,e,r){var o=this;o.users=r.users,o.project={user:""},o.close=function(){e.close(o.project)},o.dismiss=function(){e.dismiss()}}])}(),function(){"use strict";angular.module("app").controller("ProjectEditController",["project","Projects","Users",function(t,e,r){var o=this;o.users=r.users,o.project=t,o.projectCopy=_.clone(t),o.update=e.put}])}(),function(){"use strict";angular.module("app").controller("ProjectController",["project","Projects",function(t,e){var r=this;r.project=t,r.del=e.del}])}(),function(){"use strict";angular.module("app").controller("ProjectsController",["projects","Projects","$modal","$state","$rootScope",function(t,e,r,o,n){var s=this;s.projects=t,s.remove=e.del,s.addProject=function(t){r.open({templateUrl:"partials/projects/new.html",controller:"NewProjectCtrl",controllerAs:"newProject",size:"md"}).result.then(function(t){e.post(t)})}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJ1aS5tb2R1bGUuanMiLCJib2R5LmNvbnRyb2xsZXIuanMiLCJkaXJlY3RpdmVzL3Byb2plY3RzLXRhYmxlLmRpcmVjdGl2ZS5qcyIsImZhY3Rvcmllcy91c2VyLmZhY3RvcnkuanMiLCJsb2dpbi9sb2dpbi5jb250cm9sbGVyLmpzIiwic2VydmljZXMvcHJvamVjdHMuc2VydmljZS5qcyIsInNlcnZpY2VzL3VzZXJzLnNlcnZpY2UuanMiLCJmaWx0ZXJzL2RhdGUuZmlsdGVyLmpzIiwicHJvamVjdHMvbmV3LXByb2plY3QuY29udHJvbGxlci5qcyIsInByb2plY3RzL3Byb2plY3QtZWRpdC5jb250cm9sbGVyLmpzIiwicHJvamVjdHMvcHJvamVjdC5jb250cm9sbGVyLmpzIiwicHJvamVjdHMvcHJvamVjdHMuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInJlc29sdmUiLCJwcm9qZWN0cyIsIlByb2plY3RzIiwidXNlcnMiLCJnZXQiLCJVc2VycyIsInByb2plY3QiLCIkc3RhdGVQYXJhbXMiLCJmaW5kIiwicHJvamVjdElkIiwidm0iLCJ0aGlzIiwid2VsY29tZSIsInRoZW4iLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInNjb3BlIiwicmVtb3ZlIiwiZmFjdG9yeSIsIlVzZXIiLCJkYXRhIiwiXyIsIm1lcmdlIiwiZmlyc3RfbmFtZSIsImxhc3RfbmFtZSIsImVtYWlsIiwicHJvdG90eXBlIiwiZnVsbE5hbWUiLCJzZXJ2aWNlIiwiJGh0dHAiLCIkc3RhdGUiLCJfaWQiLCJyZXMiLCJzcGxpY2UiLCJmb3JFYWNoIiwidXNlciIsInB1c2giLCJwdXQiLCJwcm9qZWN0Q29weSIsInRpdGxlIiwicCIsImdvIiwiZXJyIiwiZGVsIiwicG9zdCIsInVzZXJJZCIsImZpbHRlciIsInRpbWVTdGFtcCIsImZvcm1hdCIsIm0iLCJtb21lbnQiLCIkc2NvcGUiLCIkbW9kYWxJbnN0YW5jZSIsImNsb3NlIiwiZGlzbWlzcyIsImNsb25lIiwidXBkYXRlIiwiJG1vZGFsIiwiJHJvb3RTY29wZSIsImFkZFByb2plY3QiLCJvcGVuIiwic2l6ZSIsInJlc3VsdCJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxZQUVBQSxTQUFBQyxPQUFBLE9BQUEsWUFBQSxTQUFBLGlCQUNBQyxRQUFBLGlCQUFBLHFCQUFBLFNBQUFDLEVBQUFDLEdBRUFBLEVBQUFDLFVBQUEsYUFFQUYsRUFDQUcsTUFBQSxTQUNBQyxJQUFBLFNBQ0FDLFlBQUEsNEJBQ0FDLFdBQUEsa0JBQ0FDLGFBQUEsb0JBR0FQLEVBQ0FHLE1BQUEsWUFDQUMsSUFBQSxZQUNBQyxZQUFBLCtCQUNBQyxXQUFBLHFCQUNBQyxhQUFBLHFCQUNBQyxTQUNBQyxVQUFBLFdBQUEsUUFBQSxTQUFBQyxFQUFBQyxHQUVBLE1BQUFELEdBQUFFLFFBR0FELE9BQUEsUUFBQSxTQUFBRSxHQUNBLE1BQUFBLEdBQUFELFdBTUFULE1BQUEsbUJBQ0FDLElBQUEsY0FDQUMsWUFBQSxnQ0FDQUMsV0FBQSxvQkFDQUMsYUFBQSxvQkFDQUMsU0FDQU0sU0FBQSxXQUFBLGVBQUEsV0FBQSxTQUFBSixFQUFBSyxFQUFBTixHQUNBLE1BQUFDLEdBQUFNLEtBQUFELEVBQUFFLGdCQUtBZCxNQUFBLHdCQUNBQyxJQUFBLFFBQ0FDLFlBQUEsOEJBQ0FDLFdBQUEsd0JBQ0FDLGFBQUEsZ0NDbkRBLFdBQ0EsWUFFQVYsU0FBQUMsT0FBQSxnQkNGQSxXQUNBLFlBQ0FELFNBQUFDLE9BQUEsT0FDQVEsV0FBQSxrQkFBQSxXQUFBLFNBQUFJLEdBQ0EsR0FBQVEsR0FBQUMsSUFDQUQsR0FBQUUsUUFBQSxNQUVBVixFQUFBRSxNQUNBUyxLQUFBLFNBQUFaLEdBQ0FTLEVBQUFULFNBQUFDLEVBQUFE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QSxpQkFBQSxRQUFBLFNBQUFxRCxFQUFBQyxFQUFBL0MsR0FDQSxHQUFBSyxHQUFBQyxJQUNBRCxHQUFBUCxNQUFBRSxFQUFBRixNQUNBTyxFQUFBSixTQUFBNkIsS0FBQSxJQUlBekIsRUFBQTJDLE1BQUEsV0FDQUQsRUFBQUMsTUFBQTNDLEVBQUFKLFVBSUFJLEVBQUE0QyxRQUFBLFdBQ0FGLEVBQUFFLGlCQ2pCQSxXQUVBLFlBRUFqRSxTQUFBQyxPQUFBLE9BQ0FRLFdBQUEseUJBQUEsVUFBQSxXQUFBLFFBQUEsU0FBQVEsRUFBQUosRUFBQUcsR0FDQSxHQUFBSyxHQUFBQyxJQUNBRCxHQUFBUCxNQUFBRSxFQUFBRixNQUNBTyxFQUFBSixRQUFBQSxFQUNBSSxFQUFBNEIsWUFBQWpCLEVBQUFrQyxNQUFBakQsR0FDQUksRUFBQThDLE9BQUF0RCxFQUFBbUMsVUNWQSxXQUVBLFlBRUFoRCxTQUFBQyxPQUFBLE9BQ0FRLFdBQUEscUJBQUEsVUFBQSxXQUFBLFNBQUFRLEVBQUFKLEdBQ0EsR0FBQVEsR0FBQUMsSUFDQUQsR0FBQUosUUFBQUEsRUFDQUksRUFBQWlDLElBQUF6QyxFQUFBeUMsVUNSQSxXQUVBLFlBRUF0RCxTQUFBQyxPQUFBLE9BQ0FRLFdBQUEsc0JBQUEsV0FBQSxXQUFBLFNBQUEsU0FBQSxhQUFBLFNBQUFHLEVBQUFDLEVBQUF1RCxFQUFBM0IsRUFBQTRCLEdBQ0EsR0FBQWhELEdBQUFDLElBQ0FELEdBQUFULFNBQUFBLEVBQ0FTLEVBQUFPLE9BQUFmLEVBQUF5QyxJQUdBakMsRUFBQWlELFdBQUEsU0FBQXJELEdBQ0FtRCxFQUFBRyxNQUNBL0QsWUFBQSw2QkFDQUMsV0FBQSxpQkFDQUMsYUFBQSxhQUNBOEQsS0FBQSxPQUNBQyxPQUFBakQsS0FBQSxTQUFBbUIsR0FDQTlCLEVBQUEwQyxLQUFBWiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsndWkucm91dGVyJywgJ2FwcC51aScsICd1aS5ib290c3RyYXAnXSlcbiAgICAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG5cbiAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9wcm9qZWN0cycpO1xuXG4gICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICAgIHVybDonL2xvZ2luJyxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL2xvZ2luL2luZGV4Lmh0bWwnLFxuICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkNvbnRyb2xsZXInLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2xvZ2luQ29udHJvbGxlcidcbiAgICAgICAgfSlcblxuICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgLnN0YXRlKCdwcm9qZWN0cycsIHtcbiAgICAgICAgICB1cmw6ICcvcHJvamVjdHMnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAncGFydGlhbHMvcHJvamVjdHMvaW5kZXguaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjogJ1Byb2plY3RzQ29udHJvbGxlcicsXG4gICAgICAgICAgY29udHJvbGxlckFzOiAncHJvamVjdHNDb250cm9sbGVyJyxcbiAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICBwcm9qZWN0czogZnVuY3Rpb24gKFByb2plY3RzLCB1c2Vycykge1xuICAgICAgICAgICAgICAvL3JldHVybnMgYSBwcm9taXNlLCBjb250cm9sbGVyIGlzIGNhbGxlZCB3aGVuIHByb21pc2UgaXMgcmVzb2x2ZWRcbiAgICAgICAgICAgICAgcmV0dXJuIFByb2plY3RzLmdldCgpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdXNlcnM6IGZ1bmN0aW9uIChVc2Vycykge1xuICAgICAgICAgICAgICByZXR1cm4gVXNlcnMuZ2V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IFxuICAgICAgICB9KVxuXG4gICAgICAgIC5zdGF0ZSgncHJvamVjdHMuZGV0YWlsJywge1xuICAgICAgICAgIHVybDogJy86cHJvamVjdElkJyxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL3Byb2plY3RzL2RldGFpbC5odG1sJyxcbiAgICAgICAgICBjb250cm9sbGVyOiAnUHJvamVjdENvbnRyb2xsZXInLFxuICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3Byb2plY3RDb250cm9sbGVyJyxcbiAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICBwcm9qZWN0OiBmdW5jdGlvbiAoUHJvamVjdHMsICRzdGF0ZVBhcmFtcywgcHJvamVjdHMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIFByb2plY3RzLmZpbmQoJHN0YXRlUGFyYW1zLnByb2plY3RJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBcbiAgICAgICAgfSlcblxuICAgICAgICAuc3RhdGUoJ3Byb2plY3RzLmRldGFpbC5lZGl0Jywge1xuICAgICAgICAgIHVybDogJy9lZGl0JyxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL3Byb2plY3RzL2VkaXQuaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjogJ1Byb2plY3RFZGl0Q29udHJvbGxlcicsXG4gICAgICAgICAgY29udHJvbGxlckFzOiAncHJvamVjdEVkaXRDb250cm9sbGVyJ1xuICAgICAgICB9KTtcblxuICAgIH0pO1xufSgpKTtcbiIsIihmdW5jdGlvbiAoKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyLm1vZHVsZSgnYXBwLnVpJywgW10pO1xuXG59KCkpOyIsIlxuKGZ1bmN0aW9uICgpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuY29udHJvbGxlcignQm9keUNvbnRyb2xsZXInLCBmdW5jdGlvbihQcm9qZWN0cyl7XG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgdm0ud2VsY29tZSA9ICdTdXAnO1xuICAgICAgXG4gICAgICBQcm9qZWN0cy5nZXQoKVxuICAgICAgICAudGhlbihmdW5jdGlvbihwcm9qZWN0cykge1xuICAgICAgICAgIHZtLnByb2plY3RzID0gUHJvamVjdHMucHJvamVjdHM7XG5cdH0pO1xuICAgIH0pO1xufSgpKTtcbiIsIihmdW5jdGlvbiAoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAudWknKVxuICAgIC5kaXJlY3RpdmUoJ3Byb2plY3RzVGFibGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0VBJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdwYXJ0aWFscy9kaXJlY3RpdmVzL3Byb2plY3RzLXRhYmxlLmh0bWwnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgIHByb2plY3RzOiAnPScsXG4gICAgICAgICAgcmVtb3ZlOiAnPSdcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KTtcbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdFx0LmZhY3RvcnkoJ1VzZXInLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRmdW5jdGlvbiBVc2VyKGRhdGEpIHtcblx0XHRcdFx0Xy5tZXJnZSh0aGlzLCB7XG5cdFx0XHRcdFx0Zmlyc3RfbmFtZTogJycsXG5cdFx0XHRcdFx0bGFzdF9uYW1lOiAnJyxcblx0XHRcdFx0XHRlbWFpbDogJydcblx0XHRcdFx0fSwgZGF0YSB8fCB7fSk7XG5cdFx0XHR9XG5cblx0XHRcdFVzZXIucHJvdG90eXBlID0ge1xuXHRcdFx0XHRmdWxsTmFtZTogZnVuY3Rpb24gZnVsbE5hbWUoKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuZmlyc3RfbmFtZSArICcgJyArIHRoaXMubGFzdF9uYW1lO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0cmV0dXJuIFVzZXI7XG5cblx0XHR9KTtcbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgfSk7XG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLnNlcnZpY2UoJ1Byb2plY3RzJywgZnVuY3Rpb24gKCRodHRwLCAkc3RhdGUsIFVzZXJzKSB7XG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgdm0ucHJvamVjdHMgPSBbXTtcblxuICAgICAgdm0uZmluZCA9IGZ1bmN0aW9uIGZpbmQocHJvamVjdElkKSB7XG4gICAgICAgIHJldHVybiBfLmZpbmQodm0ucHJvamVjdHMsIHtfaWQ6IHByb2plY3RJZH0pO1xuICAgICAgfTtcblxuICAgICAgdm0uZ2V0ID0gZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvcHJvamVjdHMnKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgIFx0ICAgIFxuICAgICAgICAgICAgdm0ucHJvamVjdHMuc3BsaWNlKDApO1xuXG4gICAgICBcdCAgICByZXMuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9qZWN0KSB7XG4gICAgICAgICAgICAgICBwcm9qZWN0LnVzZXIgPSBVc2Vycy5maW5kKHByb2plY3QudXNlcik7XG4gICAgXHQgICAgICAgICB2bS5wcm9qZWN0cy5wdXNoKHByb2plY3QpO1xuICAgIFx0ICAgICAgfSk7XG5cbiAgICBcdCAgICAgIHJldHVybiB2bS5wcm9qZWN0cztcbiAgICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIHZtLnB1dCA9IGZ1bmN0aW9uIHB1dChwcm9qZWN0Q29weSkge1xuICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICB0aXRsZTogcHJvamVjdENvcHkudGl0bGUsXG4gICAgICAgICAgdXNlcjogcHJvamVjdENvcHkudXNlci5faWRcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gJGh0dHAucHV0KCcvcHJvamVjdHMvJyArIHByb2plY3RDb3B5Ll9pZCwgZGF0YSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICBkZWJ1Z2dlcjtcbiAgICAgICAgICAgIHZhciBwID0gdm0uZmluZChwcm9qZWN0Q29weS5faWQpO1xuICAgICAgICAgICAgXy5tZXJnZShwLCBwcm9qZWN0Q29weSk7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3Byb2plY3RzLmRldGFpbCcsIHtwcm9qZWN0SWQ6IHByb2plY3RDb3B5Ll9pZH0pO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIC8vVE9ETzogaGFuZGxlIHdoZW4gd2UgY2FuJ3QgdXBkYXRlIGEgcHJvamVjdC5cbiAgICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIC8vdGVsbCBzZXJ2ZXIgdG8gZGVsZXRlIChyZW1vdmUpIGZyb20gZGF0YWJhc2VcbiAgICAgIHZtLnJlbW92ZSA9IGZ1bmN0aW9uIHJlbW92ZShwcm9qZWN0SWQpIHtcbiAgICAgICAgIF8ucmVtb3ZlKHZtLnByb2plY3RzLCB7X2lkOiBwcm9qZWN0SWR9KTtcbiAgICAgIH07XG5cbiAgICAgIHZtLmRlbCA9IGZ1bmN0aW9uIGRlbChwcm9qZWN0SWQpIHtcbiAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL3Byb2plY3RzLycgKyBwcm9qZWN0SWQpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgdm0ucmVtb3ZlKHByb2plY3RJZCk7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3Byb2plY3RzJyk7XG4gICAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICAvL3RlbGwgc2VydmVyIHRvIHBvc3QgKHNhdmUpIHRvIHRoZSBkYXRhYmFzZVxuICAgICAgdm0ucG9zdCA9IGZ1bmN0aW9uIHBvc3QocHJvamVjdCkge1xuICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL3Byb2plY3RzLycsIHByb2plY3QpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgcmVzLmRhdGEudXNlciA9IFVzZXJzLmZpbmQocmVzLmRhdGEudXNlcik7XG4gICAgICAgICAgICB2bS5wcm9qZWN0cy5wdXNoKHJlcy5kYXRhKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgIH0pO1xufSgpKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuc2VydmljZSgnVXNlcnMnLCBmdW5jdGlvbiAoJGh0dHAsIFVzZXIpe1xuICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgIHZtLnVzZXJzID0gW107XG5cbiAgICAgIHZtLmZpbmQgPSBmdW5jdGlvbiBmaW5kKHVzZXJJZCkge1xuICAgICAgICByZXR1cm4gXy5maW5kKHZtLnVzZXJzLCB7X2lkOiB1c2VySWR9KTtcbiAgICAgIH07XG5cbiAgICAgIC8vZ2V0IHVzZXJzIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgICB2bS5nZXQgPSBmdW5jdGlvbiBnZXQoKXtcbiAgICAgIFx0cmV0dXJuICRodHRwLmdldCgnL3VzZXJzJylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgIHZtLnVzZXJzLnNwbGljZSgwKTtcbiAgICAgICAgICBcbiAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goZnVuY3Rpb24gKHVzZXIpIHtcblx0ICAgICAgICAgICAgdm0udXNlcnMucHVzaChuZXcgVXNlcih1c2VyKSk7XG5cdCAgICAgICAgfSk7XG5cbiAgICAgICAgXHRyZXR1cm4gdm0udXNlcnM7XG4gICAgXHR9KTtcbiAgICAgIH07XG5cbiAgICB9KTtcbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAudWknKVxuXHRcdC5maWx0ZXIoJ25pY2VEYXRlJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uICh0aW1lU3RhbXAsIGZvcm1hdCkge1xuXHRcdFx0XHRmb3JtYXQgPSBmb3JtYXQgfHwgJ01NTU0gRG8sIFlZWVknO1xuXHRcdFx0XHR2YXIgbSA9IG1vbWVudCh0aW1lU3RhbXApO1xuXHRcdFx0XHRyZXR1cm4gbS5mb3JtYXQoZm9ybWF0KTtcblx0XHR9O1xuXHRcblx0fSk7XG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuY29udHJvbGxlcignTmV3UHJvamVjdEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgVXNlcnMpe1xuICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgIHZtLnVzZXJzID0gVXNlcnMudXNlcnM7XG4gICAgICB2bS5wcm9qZWN0ID0ge3VzZXI6ICcnfTtcbiAgICAgIFxuXG5cbiAgICAgIHZtLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKXtcbiAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2Uodm0ucHJvamVjdCk7XG5cbiAgICAgIH07XG5cbiAgICAgIHZtLmRpc21pc3MgPSBmdW5jdGlvbiBkaXNtaXNzKCl7XG4gICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoKTtcbiAgICAgIH07XG5cbiAgICB9KTtcbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ1Byb2plY3RFZGl0Q29udHJvbGxlcicsIGZ1bmN0aW9uIChwcm9qZWN0LCBQcm9qZWN0cywgVXNlcnMpIHtcbiAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICB2bS51c2VycyA9IFVzZXJzLnVzZXJzO1xuICAgICAgdm0ucHJvamVjdCA9IHByb2plY3Q7XG4gICAgICB2bS5wcm9qZWN0Q29weSA9IF8uY2xvbmUocHJvamVjdCk7XG4gICAgICB2bS51cGRhdGUgPSBQcm9qZWN0cy5wdXQ7XG4gICAgfSk7XG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdQcm9qZWN0Q29udHJvbGxlcicsIGZ1bmN0aW9uIChwcm9qZWN0LFByb2plY3RzKSB7XG4gICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgdm0ucHJvamVjdCA9IHByb2plY3Q7XG4gICAgICB2bS5kZWwgPSBQcm9qZWN0cy5kZWw7XG4gICAgfSk7XG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5jb250cm9sbGVyKCdQcm9qZWN0c0NvbnRyb2xsZXInLCBmdW5jdGlvbiAocHJvamVjdHMsIFByb2plY3RzLCAkbW9kYWwsICRzdGF0ZSwgJHJvb3RTY29wZSkge1xuICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgIHZtLnByb2plY3RzID0gcHJvamVjdHM7XG4gICAgICB2bS5yZW1vdmUgPSBQcm9qZWN0cy5kZWw7XG5cbiAgICAgIC8qIEFkZGluZyBhIG5ldyBwcm9qZWN0ICovXG4gICAgICB2bS5hZGRQcm9qZWN0ID0gZnVuY3Rpb24gYWRkUHJvamVjdChwcm9qZWN0KSB7XG4gICAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJG1vZGFsLm9wZW4oe1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAncGFydGlhbHMvcHJvamVjdHMvbmV3Lmh0bWwnLFxuICAgICAgICAgIGNvbnRyb2xsZXI6ICdOZXdQcm9qZWN0Q3RybCcsXG4gICAgICAgICAgY29udHJvbGxlckFzOiAnbmV3UHJvamVjdCcsXG4gICAgICAgICAgc2l6ZTogJ21kJ1xuICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICBQcm9qZWN0cy5wb3N0KHJlcyk7XG4gICAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH0pO1xufSgpKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
